var Notification=Backbone.View.extend({tagName:"div",className:"notification",initialize:function(A){_.extend(this,A)},render:function(){this.$el.html(this.options.text).addClass(this.type).delay(this.wait).slideUp("fast");return this}});var Loader=Notification.extend({className:"notification loader",render:function(){this.$el.html(this.options.text).append($("<em>"));return this},finish:function(){this.$el.fadeOut("fast",function(){this.$el.remove()}.bind(this))}});var ProgressBar=Loader.extend({className:"notification progress",update:function(A){this.$el.find("em").width(A+"%");return this}});var Notifier=Backbone.View.extend({className:"notifications",wait:1000,initialize:function(A){_.extend(this,A);this.model.on("flash",this.notify.bind(this,"flash"));this.model.on("error",this.notify.bind(this,"error"));this.model.on("success",this.notify.bind(this,"success"));this.model.on("start:loader",this.startLoader,this);this.model.on("finish:loader",this.finishLoader,this);this.model.on("start:progress",this.startProgressBar,this);this.model.on("finish:progress",this.finishProgressBar,this);this.model.on("update:progress",this.updateProgressBar,this)},notify:function(A,D,C){var B=new Notification({text:D,type:A,wait:C||this.wait}).render();this.$el.append(B.$el);return B},startLoader:function(A){if(this.loader){return}this.loader=new Loader({text:A}).render();this.$el.append(this.loader.el)},finishLoader:function(){this.loader.finish();this.loader=null},startProgressBar:function(A){if(this.progressBar){return}this.progressBar=new ProgressBar({text:A}).render();this.$el.append(this.progressBar.el)},updateProgressBar:function(A){if(!this.progressBar){return}this.progressBar.update(A)},finishProgressBar:function(){if(!this.progressBar){return}this.progressBar.update(100);_.delay(this.progressBar.finish.bind(this.progressBar),this.wait);this.progressBar=null}});